<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>TransformationCommand.CollectLastValidStateMapping Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="CollectLastValidStateMapping method" /><meta name="System.Keywords" content="TransformationCommand.CollectLastValidStateMapping method" /><meta name="Microsoft.Help.F1" content="Indg.Hex.Controller.Commands.TransformationCommand.CollectLastValidStateMapping" /><meta name="Microsoft.Help.Id" content="M:Indg.Hex.Controller.Commands.TransformationCommand.CollectLastValidStateMapping(Indg.Hex.Controller.Commands.Utils.ElementsState,Indg.Hex.Model.Stage.ElementSelection)" /><meta name="Description" content="Restores the elements in the selection to the last valid state. The last valid state can be passed null, in that case the current state is used as the last valid state." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Indg.Hex.Controller.Commands" /><meta name="file" content="287bf0ed-b9c3-98da-3b88-13d934975998" /><meta name="guid" content="287bf0ed-b9c3-98da-3b88-13d934975998" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">RoomBuilder API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="dfb656b5-1268-8b69-3ed9-c93c2fe563f8.htm" title="RoomBuilder API Documentation" tocid="roottoc">RoomBuilder API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="aeacf6ac-adb0-9f34-d6c2-d747ad4d59da.htm" title="Indg Namespaces" tocid="aeacf6ac-adb0-9f34-d6c2-d747ad4d59da">Indg Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="8fc25b50-0e51-822f-348c-795d0213da57.htm" title="Indg.Hex Namespaces" tocid="8fc25b50-0e51-822f-348c-795d0213da57">Indg.Hex Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="7dc1e779-dac3-4263-62d2-8094dad8a474.htm" title="Indg.Hex.Controller.Commands" tocid="7dc1e779-dac3-4263-62d2-8094dad8a474">Indg.Hex.Controller.Commands</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="a9eab26e-074f-874e-cf0b-861f648ddcec.htm" title="TransformationCommand Class" tocid="a9eab26e-074f-874e-cf0b-861f648ddcec">TransformationCommand Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="a7cd10fc-4bd1-7e95-8e22-8165ac62430c.htm" title="TransformationCommand Methods" tocid="a7cd10fc-4bd1-7e95-8e22-8165ac62430c">TransformationCommand Methods</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="287bf0ed-b9c3-98da-3b88-13d934975998.htm" title="CollectLastValidStateMapping Method " tocid="287bf0ed-b9c3-98da-3b88-13d934975998">CollectLastValidStateMapping Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="f2845450-8d38-0b3b-83ba-3c59fcf56bfd.htm" title="CreateTransformationVO Method " tocid="f2845450-8d38-0b3b-83ba-3c59fcf56bfd">CreateTransformationVO Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="50e14b6d-d19f-7c5c-4c01-48e485ed9990.htm" title="Execute Method " tocid="50e14b6d-d19f-7c5c-4c01-48e485ed9990">Execute Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="9ae6d920-e388-c8e0-b9e1-4fc2f9bbb4a6.htm" title="ExecuteTransformation Method " tocid="9ae6d920-e388-c8e0-b9e1-4fc2f9bbb4a6">ExecuteTransformation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="c31a2483-644b-3a44-074a-b4f75262606f.htm" title="FinalizeUpdateTransformation Method " tocid="c31a2483-644b-3a44-074a-b4f75262606f">FinalizeUpdateTransformation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="2bec36e3-77d7-db64-e9e5-afc3df5e010d.htm" title="HandleTransformationResult Method " tocid="2bec36e3-77d7-db64-e9e5-afc3df5e010d">HandleTransformationResult Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="7c2886c9-e87b-7445-0d31-858553530cdb.htm" title="IsValidResult Method " tocid="7c2886c9-e87b-7445-0d31-858553530cdb">IsValidResult Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="2a7da23d-3d86-86c6-92d4-79bebace4e6e.htm" title="RemoveTransformationVO Method " tocid="2a7da23d-3d86-86c6-92d4-79bebace4e6e">RemoveTransformationVO Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d9649177-2aac-39b7-66d1-4a6a5e079c52.htm" title="RetrieveTransformationVO Method " tocid="d9649177-2aac-39b7-66d1-4a6a5e079c52">RetrieveTransformationVO Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="11a1954c-2729-ffef-abaf-435f1bde33f1.htm" title="UpdateIgnoreRuleDataFailInfo Method " tocid="11a1954c-2729-ffef-abaf-435f1bde33f1">UpdateIgnoreRuleDataFailInfo Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/logo.png" /></td><td class="titleColumn">TransformationCommand<span id="LSTBDE1D48C_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBDE1D48C_0?cpp=::|nu=.");</script>CollectLastValidStateMapping Method </td></tr></table><span class="introStyle"></span><div class="summary">
            Restores the elements in the selection to the last valid state. The last valid state can be passed null, in
            that case the current state is used as the last valid state.
            </div><p> </p><strong>Namespace:</strong> <a href="7dc1e779-dac3-4263-62d2-8094dad8a474.htm">Indg.Hex.Controller.Commands</a><br /><strong>Assembly:</strong> Hex (in Hex.dll) Version: 1.0.5714.23726<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EACA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">protected</span> <span class="identifier">Dictionary</span>&lt;<span class="identifier">Element</span>, <span class="identifier">ValidElementState</span>&gt; <span class="identifier">CollectLastValidStateMapping</span>(
	<span class="identifier">ElementsState</span> <span class="parameter">aLastValidState</span>,
	<span class="identifier">ElementSelection</span> <span class="parameter">aElementSelection</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">aLastValidState</span></dt><dd>Type: <a href="d2bc3c98-0739-45c6-d626-e562373ef952.htm">Indg.Hex.Controller.Commands.Utils<span id="LSTBDE1D48C_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBDE1D48C_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ElementsState</a><br />The last valid state, note that <div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EABCBA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0EABCBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EABCBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">null</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EABCBA");</script> is a valid value.</dd><dt><span class="parameter">aElementSelection</span></dt><dd>Type: <a href="cec1f158-0502-3b18-859a-ceef0443f926.htm">Indg.Hex.Model.Stage<span id="LSTBDE1D48C_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBDE1D48C_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ElementSelection</a><br />The elements to restore.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/xfhwa508" target="_blank">Dictionary</a><span id="LSTBDE1D48C_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBDE1D48C_3?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="b2f9dfd1-56ee-a839-e317-f4e64c771abc.htm">Element</a>, <a href="d5e87aa4-f8e2-1737-f3bb-71ddb82651cd.htm">ValidElementState</a><span id="LSTBDE1D48C_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBDE1D48C_4?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br />Returns a map from the element to the valid element state data.</div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="a9eab26e-074f-874e-cf0b-861f648ddcec.htm">TransformationCommand Class</a></div><div class="seeAlsoStyle"><a href="7dc1e779-dac3-4263-62d2-8094dad8a474.htm">Indg.Hex.Controller.Commands Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>